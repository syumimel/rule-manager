# ILE フォーマット仕様

## 推奨形式: __vars__と__messages__を使用

変数を設定して使用する場合、`__vars__`と`__messages__`形式を使用することを強く推奨します。

### 書式

```json
{
  "__vars__": {
    "変数名1": "値またはILE式",
    "変数名2": "${rand:1:100}",
    "変数名3": "${rand(1, 100)}"
  },
  "__messages__": [
    {"type": "text", "text": "メッセージ1"},
    {"type": "text", "text": "メッセージ2"}
  ]
}
```

### 使用例

```json
{
  "__vars__": {
    "userName": "田中",
    "row_idx": "${rand:1:100}"
  },
  "__messages__": [
    {"type": "text", "text": "こんにちは、${userName}さん！"},
    {"type": "text", "text": "ラッキーナンバーは${row_idx}です✨"}
  ]
}
```

### 変換後

```json
[
  {"type": "text", "text": "こんにちは、田中さん！"},
  {"type": "text", "text": "ラッキーナンバーは42です✨"}
]
```

## 乱数の書式

`__vars__`内では、以下の2つの形式が使用できます：

1. **コロン区切り形式（推奨）**: `${rand:1:100}`
2. **関数呼び出し形式**: `${rand(1, 100)}`

どちらも同じ動作をします。

## 変数のスコープ

`__vars__`で定義した変数は、`__messages__`内の全てのメッセージで使用できます。

## 動作の流れ

1. `__vars__`内の各値を評価して変数コンテキストに保存
2. `__messages__`内の各メッセージを処理
3. メッセージ内の`${変数名}`が変数の値に置換される

